#+TITLE: Changelog
#+STARTUP: overview

* Unreleased

** Bugfixes

- Fixed layout parser incorrectly counting plugin panes (tab-bar, status-bar) as real panes
- Fixed layout parser counting container panes with =split_direction= as actual panes
- Parser now correctly matches terminal's pane count by skipping infrastructure panes
- Fixed new panes/tabs starting in home directory instead of project root
  - Now properly expands paths to absolute paths (resolving ~)
- Fixed pane navigation not reaching correct target pane
  - **Critical fix**: Changed from using tab indices to tab names for navigation
  - =zellij action go-to-tab= with indices was unreliable, now using =go-to-tab-name=
  - Now parses layout to find current focused pane and calculates correct cycle count
  - Added timing delays to ensure Zellij processes tab switches and pane focus commands
  - Added enhanced logging to track navigation flow
  - **CRITICAL**: Fixed race condition where navigation would silently fail if no pane was focused after tab switch
  - Increased tab switch delay from 0.1s to 0.2s for more reliable focus detection
  - Navigation now defaults to pane 0 if no focused pane is detected (instead of failing)
  - Added explicit error handling for when target tab is not found
  - **FINAL FIX**: Text was still being sent to wrong pane due to focus switching back
  - Root cause: Commands sent from Emacs (in Tab #9) caused Zellij to switch focus back before text was sent
  - Solution: Chain all commands in single shell execution (=go-to-tab-name && focus-next-pane && write-chars=)
  - This prevents focus from switching back between navigation and sending
  - New =zellij--send-with-navigation= function handles atomic navigation + send
- Fixed read-only buffer error when logging to =*Zellij Log*= buffer
  - Log function now properly disables read-only mode when writing
- Fixed org-mode integration treating numeric tab properties as indices instead of tab names
  - =#+PROPERTY: ZELLIJ_TAB 11= now correctly maps to "Tab #11" (tab name) instead of tab index 11
  - Same fix applied to header arguments =:zellij-tab 11=
  - This ensures org-mode targets match Zellij's actual tab naming convention

** Features

- Auto-set target pane to current focused pane on first send
- Pane validation before sending to detect closed panes
- Automatic target clearing when pane no longer exists
- Enhanced pane selection: =zellij-set-target-pane= now shows ALL tabs and panes
- New command =zellij-list-panes= (=C-c z i=) to view all available panes
- AI CLI panes are marked with =[AI: name]= prefix in pane selection
- Currently focused pane is marked with =*= in pane selection
- Simplified display format: shows tab names directly instead of "Tab 0: Tab #8"
- Tab creation: =zellij-new-tab= and =zellij-new-tab-with-name= (=C-c z N=)

* Version 0.0.1 (2025-01-05)

Initial release.

** Features

- Core Zellij integration
- Send commands to specific tabs and panes
- AI CLI auto-detection (Claude Code, OpenCode, Aider, Cursor, etc.)
- Smart code block formatting for AI interactions
- Buffer-local target pane tracking
- Mode-line indicator
- Project-aware pane creation
- Org-mode source block execution
- Comprehensive logging
- Minor mode with keybindings
